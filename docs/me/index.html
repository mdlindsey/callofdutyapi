<!DOCTYPE html>
<html lang='en'>
<head>
	<meta class="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>Dashboard / Call of Duty API - Provided by WARZONE.AI</title>
	<!-- Don't forget to add your metadata here -->
	<link rel='stylesheet' href='../assets/css/style.css' />
	<link rel='shortcut icon' type='image/x-icon' href='../assets/img/favicon.ico' />
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-NL88L2YKLJ"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('config', 'G-NL88L2YKLJ');
	</script>
    <style type="text/css">
        #dashboard {
            min-height: 90vh;
            padding-top: 10vh;
        }
        #create-app-button {
            position: absolute;
            top: 0;
            right: 0;
        }
        .two-pane-panel {
            position: relative;
            display: inline-block;
            vertical-align: top;
            width: calc(50% - 32px);
        }

        #dashboard ul {
            list-style: none;
            margin: 32px 0 0 0;
            padding: 0;
        }
        #dashboard ul li {
            padding: 0;
            cursor: pointer;
            border: 1px solid transparent;
        }
        #dashboard ul li:hover {
            border: 1px solid rgba(0,0,0,0.05);
        }
        #dashboard ul li h3 {
            margin: 0;
            padding: 0;
            display: inline-block;
            width: 60%;
        }
        #dashboard ul li a {
            display: inline-block;
            width: 40%;
            text-align: right;
        }
        #dashboard ul li .app-header {
            padding: 12px;
        }
        #dashboard ul li .app-header:hover {
            background: rgba(0,0,0,0.05);
        }
        #dashboard ul li .app-details {
            display: none;
            padding: 12px;
        }

        .client-secret {
            display: none;
        }
    </style>
</head>
<body>
	<div class="navbar">
		<nav class="nav__mobile"></nav>
		<div class="container">
			<div class="navbar__inner">
				<a href="/" class="navbar__logo"><span id="api-status-indicator"></span>Call of Duty API</a>
				<nav class="navbar__menu">
					<ul>
						<li><a href="#logout" onClick={logout()}>Sign out</a></li>
					</ul>
				</nav>
				<div class="navbar__menu-mob"><a href="" id='toggle'><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z" class=""></path></svg></a></div>
			</div>
		</div>
	</div>

    <div class="container" id="dashboard">
        <div class="two-pane-panel">
            <h1 class="data-uno-username"></h1>
            <h2>Games: <span class="data-games"></span></h2>
        </div>
        <div class="two-pane-panel">
            <button id="create-app-button">Create App</button>
            <h2 style="margin: 0 0 32px 0;">My Applications</h2>
            <hr />
            <ul>
                <li id="app-123" onclick="toggleAppInfo('app-123');">
                    <div class="app-header">
                        <h3>WARZONE.AI</h3><a onclick={copySecret()} href="#">copy secret</a>
                    </div>
                    <div class="app-details">
                        <h6>Users</h6>
                    </div>
                </li>
            </ul>
        </div>
    </div>

	
	<!-- Footer -->
	<div class="footer footer--dark">
		<div class="container">
			<div class="footer__inner">
				<a href="https://callofdutyapi.com" class="footer__textLogo">Call of Duty API</a>
				<div class="footer__data">
					<div class="footer__data__item">
						<div class="footer__row">
							Created by <a href="https://github.com/mdlindsey" target="_blank" class="footer__link">Dan Lindsey</a>
						</div>
					</div>
					<div class="footer__data__item">
						<div class="footer__row">
							UI Design by <a href="https://undraw.co" target="_blank" class="footer__link">unDraw</a>
						</div>
					</div>
					<div class="footer__data__item">
					<div class="footer__row">
						<a href="https://www.npmjs.com/package/@callofduty/api" target="_blank" class="footer__link">NPM</a>
					</div>
					<div class="footer__row">
						<a href="https://github.com/mdlindsey/callofdutyapi" target="_blank" class="footer__link">GitHub</a>
					</div>
					<div class="footer__row">
						<a href="https://warzone.ai/discord/join" target="_blank" class="footer__link">Discord</a>
					</div>
				</div>
			</div>
		</div>
	</div>
<script src='../assets/js/app.js'></script>
<script>
    if (!localStorage.getItem('jwt')) {
        window.location.href = '../login'
    }
    function parseJwt(token) {
        try {
            return JSON.parse(atob(token.split('.')[1]))
        } catch (e) {
            return null
        }
    }
    function toggleAppInfo(appId) {
        const current = document.querySelector(`#${appId} .app-details`).style.display
        document.querySelector(`#${appId} .app-details`).style.display = current === 'block' ? 'none' : 'block'
    }
    function copySecret() {
        const textToCopy = 'XXXXXXXXX'
        var myTemporaryInputElement = document.createElement("input")
        myTemporaryInputElement.type = "text"
        myTemporaryInputElement.value = textToCopy

        document.body.appendChild(myTemporaryInputElement)

        myTemporaryInputElement.select()
        document.execCommand("Copy")

        document.body.removeChild(myTemporaryInputElement)
    }
    function logout() {
        localStorage.setItem('jwt', '')
        window.location.href = '../login'
    }

    function loadUI() {
        const me = parseJwt(localStorage.getItem('jwt'))
        document.querySelector('.data-games').innerHTML = me.games.map(g => g.toUpperCase()).join(', ')
        document.querySelector('.data-uno-username').innerHTML = me.profile.uno
    }

    loadUI()
</script>
</body>
</html>